{% extends 'front/base.html.twig' %}

{% block title %}
{% endblock %}

{% block body %}

    {% if produitSession|length > 0 %}
        <div id="basketUser">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 col-xl-8 cardLeft">
                        <h3 class="mt-5">Détail de votre panier</h3>
                        <hr>
                        {% set totalPrice = 0 %}
                        {% for item in produitSession %}
                            <div class="cardProduct mt-5">
                                <div class="col-12">
                                    <div class="row">
                                        <div class="col-2">
                                            <a href="{{ path('app_produit', {'slug': item['produit'].slug}) }}"><img
                                                        class="mt-3 mb-3 ms-2"
                                                        src="{{ asset('build/img/uploads/items/' ~ item['produit'].photo[0].url) }}"
                                                        alt="chien"></a>
                                        </div>
                                        <div class="col-5 col-md-6 col-lg-6">
                                            <h4 class="title ms-5 mt-4">{{ item['produit'].marque.nom }}</h4>
                                            <p class="libelle ms-5 mt-1">{{ item['produit'].libelle }}</p>
                                        </div>
                                        <div class="col-5 col-md-4 col-lg-4 mt-3 text-center">
                                            <div class="col-12">
                                                {% if item['produit'].promotion is not null %}
                                                    <span class="price">{{ (item['produit'].prixHt | prixTtc(item['produit'].tva,item['produit'].promotion.pourcentage)) * item['qty'] }}€</span>
                                                    <span class="qty"> ({{ item['qty'] }})</span>
                                                    <p class="promo">Avec
                                                        remise {{ item['produit'].promotion.pourcentage }}% </p>
                                                    {% set totalPrice = totalPrice + (item['produit'].prixHt | prixTtc(item['produit'].tva,item['produit'].promotion.pourcentage)) * item['qty'] %}
                                                {% else %}
                                                    <div class="mb-3">
                                                        <span class="price">{{ (item['produit'].prixHt | prixTtc(item['produit'].tva,0)) * item['qty'] }}€</span>
                                                        <span class="qty"> ({{ item['qty'] }})</span>
                                                        {% set totalPrice = totalPrice + (item['produit'].prixHt | prixTtc(item['produit'].tva,0)) * item['qty'] %}
                                                    </div>
                                                {% endif %}
                                            </div>
                                            <div class="col-12">
                                                <a class="btn btn-primary mb-3"
                                                   href="{{ path('app_delete_Item', {'id': item['produit'].id}) }}">Supprimer</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <div class="col-lg-12 col-xl-4 cardRight">
                        <h3 class="mt-5">Récapitulatif</h3>
                        <hr>
                        <div class="cardShipping mt-5">
                            <div class="row">
                                <div class="col-12">
                                    <div class="row d-flex justify-content-evenly">
                                        <div class="col-6">
                                            <h4 class="mt-5 ms-3">Total:</h4>
                                        </div>
                                        <div class="col-6 d-flex justify-content-end">
                                            <h3 class="price mt-5 me-3">{{ totalPrice }}€</h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 ms-3">
                                    <p>Nombre de produits total:
                                        ({{ app.session.get('QTY') }} {% if app.session.get('QTY') == 1 %}article{% else %}articles{% endif %}
                                        ) </p>
                                </div>
                                <div class="col-12 text-center mt-5">
                                    <div class="ms-3 me-3">
                                        <a class="col-12 btn btn-primary" href="{{ path('app_register') }}">Etape
                                            suivante</a>
                                    </div>
                                </div>
                                <div class="col-12 ms-3 mt-5">
                                    <i class="fas fa-shipping-fast"></i>
                                    <span class="ms-2">Livraison en 24h</span>
                                </div>
                                <div class="col-12 ms-3 mt-3">
                                    <i class="fas fa-arrow-rotate-backward"></i>
                                    <span class="ms-2">Retour 30 jours</span>
                                </div>
                                <div class="col-12 ms-3 mt-3 mb-5">
                                    <i class="fas fa-lock"></i>
                                    <span class="ms-2">Paiement sécurisé</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}

{% endblock %}



                {#                        <div class="d-flex justify-content-end me-5"> #}
                {#                            <a class="btn btn-danger mt-5" href="{{ path('app_delete_cart') }}"> #}
                {#                                Vider mon panier #}
                {#                            </a> #}
                {#                        </div> #}